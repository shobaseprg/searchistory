rules_version = '2';
  // function isExistMyUidInField(field){
  //   return
  // }
  function isAuth(){
    return request.auth != null
  }
  function myUID(){
    return request.auth.uid
  }
  function existingData(){
    return resource.data
  }
  function incomingData(){
    return request.resource.data
  }
  function isContainProhibitedField(fieldList){
    return incomingData().diff(existingData()).affectedKeys().hasAny(fieldList);
  }
  function isAvalableFieldOnCreate(fieldList){
    return incomingData().keys().hasOnly(fieldList)
  }

service cloud.firestore {
  match /databases/{database}/documents {
      match /user/{docID} {
      allow read: if isAuth();
      allow create:
        if isAuth()
        && docID == myUID()
        && incomingData().uid == myUID()
        && isAvalableFieldOnCreate(["name","email","uid","memberUIDs"])
      allow update:
        if isAuth()
        && docID == myUID()
        && isContainProhibitedField(["uid"])
        && isContainProhibitedField(["uid"])
    }
  }
  match /topic/{docID} {
    allow read, write: if request.auth != null && isExistMyUidInField("authorizedUIDs");
  }
}
